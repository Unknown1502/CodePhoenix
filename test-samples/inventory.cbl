IDENTIFICATION DIVISION.
PROGRAM-ID. INVENTORY-SYSTEM.
AUTHOR. LEGACY-DEVELOPER.
DATE-WRITTEN. 1985-03-15.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SOURCE-COMPUTER. IBM-370.
OBJECT-COMPUTER. IBM-370.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 ITEM-RECORD.
   05 ITEM-ID         PIC 9(6).
   05 ITEM-NAME       PIC X(30).
   05 ITEM-PRICE      PIC 9(5)V99.
   05 ITEM-QUANTITY   PIC 9(4).
   
01 TOTAL-VALUE       PIC 9(8)V99.
01 WS-EOF            PIC A(1).
01 COUNTER           PIC 9(4) VALUE ZERO.

PROCEDURE DIVISION.
MAIN-LOGIC.
    PERFORM INITIALIZATION.
    PERFORM PROCESS-ITEMS UNTIL WS-EOF = 'Y'.
    PERFORM FINALIZATION.
    STOP RUN.

INITIALIZATION.
    MOVE 'N' TO WS-EOF.
    MOVE ZERO TO TOTAL-VALUE.
    MOVE ZERO TO COUNTER.
    DISPLAY "==================================".
    DISPLAY "  INVENTORY MANAGEMENT SYSTEM    ".
    DISPLAY "  Version 1.0 - Legacy Edition   ".
    DISPLAY "==================================".

PROCESS-ITEMS.
    ADD 1 TO COUNTER.
    MOVE 123456 TO ITEM-ID.
    MOVE "Widget A" TO ITEM-NAME.
    MOVE 99.99 TO ITEM-PRICE.
    MOVE 100 TO ITEM-QUANTITY.
    
    COMPUTE TOTAL-VALUE = TOTAL-VALUE + (ITEM-PRICE * ITEM-QUANTITY).
    DISPLAY "Processed Item #" COUNTER ": " ITEM-NAME.
    DISPLAY "  Price: $" ITEM-PRICE " x Quantity: " ITEM-QUANTITY.
    
    IF COUNTER >= 3
        MOVE 'Y' TO WS-EOF
    END-IF.

FINALIZATION.
    DISPLAY "==================================".
    DISPLAY "Total Items Processed: " COUNTER.
    DISPLAY "Total Inventory Value: $" TOTAL-VALUE.
    DISPLAY "==================================".
    DISPLAY "System shutdown complete.".
